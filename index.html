<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LED Screen Pong mit Mirror</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: #000;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        width: 100vw;
      }

      #canvasContainer {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
      }

      canvas {
        display: block;
        background: #000;
        image-rendering: pixelated;
        image-rendering: crisp-edges;
      }
    </style>
  </head>
  <body>
    <div id="canvasContainer">
      <canvas id="gameCanvas"></canvas>
    </div>

    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");

      // Display-Spezifikationen
      const TOTAL_WIDTH = 10368;
      const TOTAL_HEIGHT = 1536;
      const LEFT_SCREEN_WIDTH = 3968;
      const RIGHT_SCREEN_WIDTH = 6400;
      const ASPECT_RATIO = TOTAL_WIDTH / TOTAL_HEIGHT;

      canvas.width = TOTAL_WIDTH;
      canvas.height = TOTAL_HEIGHT;

      // Auto-Skalierung
      function scaleCanvas() {
        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;
        const windowRatio = windowWidth / windowHeight;

        let scale;
        if (windowRatio > ASPECT_RATIO) {
          scale = windowHeight / TOTAL_HEIGHT;
        } else {
          scale = windowWidth / TOTAL_WIDTH;
        }

        canvas.style.width = TOTAL_WIDTH * scale + "px";
        canvas.style.height = TOTAL_HEIGHT * scale + "px";
      }

      window.addEventListener("resize", scaleCanvas);
      scaleCanvas();

      // Spielvariablen
      const PADDLE_WIDTH = 40;
      const PADDLE_HEIGHT = 250;
      const BALL_SIZE = 35;
      const PADDLE_SPEED = 18;
      const INITIAL_BALL_SPEED = 10;

      let player1Y = TOTAL_HEIGHT / 2 - PADDLE_HEIGHT / 2;
      let player2Y = TOTAL_HEIGHT / 2 - PADDLE_HEIGHT / 2;
      let ballX = LEFT_SCREEN_WIDTH / 2;
      let ballY = TOTAL_HEIGHT / 2;
      let ballVelX = INITIAL_BALL_SPEED;
      let ballVelY = INITIAL_BALL_SPEED;
      let score1 = 0;
      let score2 = 0;
      let ballSpeed = INITIAL_BALL_SPEED;

      // Tastatureingaben
      const keys = {};
      document.addEventListener("keydown", (e) => {
        keys[e.key] = true;
        // Fullscreen bei F-Taste
        if (
          (e.key === "f" || e.key === "F") &&
          !document.fullscreenElement
        ) {
          enterFullscreen();
        }
      });
      document.addEventListener("keyup", (e) => (keys[e.key] = false));

      function resetBall() {
        ballX = LEFT_SCREEN_WIDTH / 2;
        ballY = TOTAL_HEIGHT / 2;
        ballSpeed = INITIAL_BALL_SPEED;
        ballVelX = (Math.random() > 0.5 ? 1 : -1) * ballSpeed;
        ballVelY = (Math.random() * 2 - 1) * ballSpeed;
      }

      function update() {
        // Spieler 1 (W/S) - Links
        if (keys["w"] || keys["W"]) {
          if (player1Y > 0) player1Y -= PADDLE_SPEED;
        }
        if (keys["s"] || keys["S"]) {
          if (player1Y < TOTAL_HEIGHT - PADDLE_HEIGHT)
            player1Y += PADDLE_SPEED;
        }

        // Spieler 2 (Pfeiltasten) - Rechts
        if (keys["ArrowUp"]) {
          if (player2Y > 0) player2Y -= PADDLE_SPEED;
        }
        if (keys["ArrowDown"]) {
          if (player2Y < TOTAL_HEIGHT - PADDLE_HEIGHT)
            player2Y += PADDLE_SPEED;
        }

        // Ball bewegen
        ballX += ballVelX;
        ballY += ballVelY;

        // Wand-Kollision (oben/unten)
        if (ballY <= 0 || ballY >= TOTAL_HEIGHT - BALL_SIZE) {
          ballVelY *= -1;
        }

        // Paddle-Kollision Spieler 1 (links)
        if (
          ballX <= 120 + PADDLE_WIDTH &&
          ballX > 100 &&
          ballY + BALL_SIZE >= player1Y &&
          ballY <= player1Y + PADDLE_HEIGHT
        ) {
          ballVelX = Math.abs(ballVelX) * 1.05;
          const hitPos = (ballY + BALL_SIZE / 2 - player1Y) / PADDLE_HEIGHT;
          ballVelY = (hitPos - 0.5) * ballSpeed * 2;
          ballSpeed *= 1.05;
        }

        // Paddle-Kollision Spieler 2 (rechts)
        if (
          ballX + BALL_SIZE >= LEFT_SCREEN_WIDTH - 120 - PADDLE_WIDTH &&
          ballX + BALL_SIZE < LEFT_SCREEN_WIDTH - 100 &&
          ballY + BALL_SIZE >= player2Y &&
          ballY <= player2Y + PADDLE_HEIGHT
        ) {
          ballVelX = -Math.abs(ballVelX) * 1.05;
          const hitPos = (ballY + BALL_SIZE / 2 - player2Y) / PADDLE_HEIGHT;
          ballVelY = (hitPos - 0.5) * ballSpeed * 2;
          ballSpeed *= 1.05;
        }

        // Scoring
        if (ballX < 0) {
          score2++;
          resetBall();
        }
        if (ballX > LEFT_SCREEN_WIDTH) {
          score1++;
          resetBall();
        }
      }

      function draw() {
        // Hintergrund
        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, TOTAL_WIDTH, TOTAL_HEIGHT);

        // === LINKER SCREEN: PONG SPIEL ===

        // Trennlinie zwischen Screens
        ctx.strokeStyle = "#ff0000";
        ctx.lineWidth = 10;
        ctx.beginPath();
        ctx.moveTo(LEFT_SCREEN_WIDTH, 0);
        ctx.lineTo(LEFT_SCREEN_WIDTH, TOTAL_HEIGHT);
        ctx.stroke();

        // Mittellinie im Spielfeld
        ctx.strokeStyle = "#333";
        ctx.lineWidth = 5;
        ctx.setLineDash([60, 40]);
        ctx.beginPath();
        ctx.moveTo(LEFT_SCREEN_WIDTH / 2, 0);
        ctx.lineTo(LEFT_SCREEN_WIDTH / 2, TOTAL_HEIGHT);
        ctx.stroke();
        ctx.setLineDash([]);

        // Spieler 1 Paddle (links, grün)
        ctx.fillStyle = "#00ff00";
        ctx.fillRect(100, player1Y, PADDLE_WIDTH, PADDLE_HEIGHT);

        // Spieler 1 Name
        ctx.font = "bold 80px Arial";
        ctx.textAlign = "center";
        ctx.fillText("PLAYER 1", LEFT_SCREEN_WIDTH / 4, 100);

        // Spieler 2 Paddle (rechts im linken screen, blau)
        ctx.fillStyle = "#00aaff";
        ctx.fillRect(
          LEFT_SCREEN_WIDTH - 100 - PADDLE_WIDTH,
          player2Y,
          PADDLE_WIDTH,
          PADDLE_HEIGHT
        );

        // Spieler 2 Name
        ctx.fillText("PLAYER 2", (LEFT_SCREEN_WIDTH * 3) / 4, 100);

        // Ball
        ctx.fillStyle = "#fff";
        ctx.shadowBlur = 20;
        ctx.shadowColor = "#fff";
        ctx.fillRect(ballX, ballY, BALL_SIZE, BALL_SIZE);
        ctx.shadowBlur = 0;

        // === RECHTER SCREEN: GESPIEGELTES SPIEL + SCORE ===

        const rightScreenStart = LEFT_SCREEN_WIDTH;
        const mirrorCenterX = rightScreenStart + RIGHT_SCREEN_WIDTH / 2;

        // Gespiegeltes Spielfeld (kleiner, zentriert)
        const mirrorScale = 0.6;
        const mirrorWidth = LEFT_SCREEN_WIDTH * mirrorScale;
        const mirrorHeight = TOTAL_HEIGHT * mirrorScale;
        const mirrorX = mirrorCenterX - mirrorWidth / 2;
        const mirrorY = (TOTAL_HEIGHT - mirrorHeight) / 2;

        // Rahmen um gespiegeltes Spiel
        ctx.strokeStyle = "#444";
        ctx.lineWidth = 8;
        ctx.strokeRect(mirrorX, mirrorY, mirrorWidth, mirrorHeight);

        // Mirror-Hintergrund
        ctx.fillStyle = "#111";
        ctx.fillRect(mirrorX, mirrorY, mirrorWidth, mirrorHeight);

        // Mittellinie im Mirror
        ctx.strokeStyle = "#333";
        ctx.lineWidth = 3;
        ctx.setLineDash([30, 20]);
        ctx.beginPath();
        ctx.moveTo(mirrorCenterX, mirrorY);
        ctx.lineTo(mirrorCenterX, mirrorY + mirrorHeight);
        ctx.stroke();
        ctx.setLineDash([]);

        // Gespiegelte Paddles
        const paddle1MirrorX = mirrorX + (100 / LEFT_SCREEN_WIDTH) * mirrorWidth;
        const paddle2MirrorX =
          mirrorX +
          ((LEFT_SCREEN_WIDTH - 100 - PADDLE_WIDTH) / LEFT_SCREEN_WIDTH) *
            mirrorWidth;
        const paddleMirrorWidth = (PADDLE_WIDTH / LEFT_SCREEN_WIDTH) * mirrorWidth;
        const paddleMirrorHeight = (PADDLE_HEIGHT / TOTAL_HEIGHT) * mirrorHeight;
        const paddle1MirrorY =
          mirrorY + (player1Y / TOTAL_HEIGHT) * mirrorHeight;
        const paddle2MirrorY =
          mirrorY + (player2Y / TOTAL_HEIGHT) * mirrorHeight;

        ctx.fillStyle = "#00ff00";
        ctx.fillRect(
          paddle1MirrorX,
          paddle1MirrorY,
          paddleMirrorWidth,
          paddleMirrorHeight
        );

        ctx.fillStyle = "#00aaff";
        ctx.fillRect(
          paddle2MirrorX,
          paddle2MirrorY,
          paddleMirrorWidth,
          paddleMirrorHeight
        );

        // Gespiegelter Ball
        const ballMirrorX = mirrorX + (ballX / LEFT_SCREEN_WIDTH) * mirrorWidth;
        const ballMirrorY = mirrorY + (ballY / TOTAL_HEIGHT) * mirrorHeight;
        const ballMirrorSize = (BALL_SIZE / LEFT_SCREEN_WIDTH) * mirrorWidth;

        ctx.fillStyle = "#fff";
        ctx.shadowBlur = 10;
        ctx.shadowColor = "#fff";
        ctx.fillRect(ballMirrorX, ballMirrorY, ballMirrorSize, ballMirrorSize);
        ctx.shadowBlur = 0;

        // SCORE - Groß über dem Mirror
        ctx.font = "bold 400px Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";

        // Player 1 Score
        ctx.fillStyle = "#00ff00";
        ctx.fillText(score1, mirrorCenterX - 500, 300);

        // Trennstrich
        ctx.fillStyle = "#666";
        ctx.fillText(":", mirrorCenterX, 300);

        // Player 2 Score
        ctx.fillStyle = "#00aaff";
        ctx.fillText(score2, mirrorCenterX + 500, 300);

        // "LIVE" Indicator
        ctx.font = "bold 100px Arial";
        ctx.fillStyle = "#ff0000";
        const time = Date.now();
        if (Math.floor(time / 500) % 2 === 0) {
          ctx.fillText("● LIVE", mirrorCenterX, TOTAL_HEIGHT - 150);
        }

        // Steuerungshinweis (verschwindet nach 5 Sekunden)
        if (time - startTime < 5000) {
          ctx.font = "bold 60px Arial";
          ctx.fillStyle = "#888";
          ctx.fillText(
            "Player 1: W/S  •  Player 2: ↑/↓  •  F: Fullscreen",
            mirrorCenterX,
            TOTAL_HEIGHT - 50
          );
        }
      }

      let startTime = Date.now();

      function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
      }

      // Auto-Fullscreen
      function enterFullscreen() {
        const elem = document.documentElement;
        if (elem.requestFullscreen) {
          elem.requestFullscreen();
        } else if (elem.webkitRequestFullscreen) {
          elem.webkitRequestFullscreen();
        } else if (elem.msRequestFullscreen) {
          elem.msRequestFullscreen();
        }
      }

      // Fullscreen bei Klick
      let firstClick = true;
      document.addEventListener("click", () => {
        if (firstClick && !document.fullscreenElement) {
          enterFullscreen();
          firstClick = false;
        }
      });

      // Spiel starten
      window.addEventListener("load", () => {
        resetBall();
        gameLoop();
        setTimeout(() => {
          if (!document.fullscreenElement) enterFullscreen();
        }, 500);
      });
    </script>
  </body>
</html>
